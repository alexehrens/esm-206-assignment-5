---
title: "ESM 206 - Pacific Giant Salamanders"
author: "Courtney Krone and Alex Ehrens"
date: "11/25/2019"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, warning = FALSE, message = FALSE)
```



```{r}
# Attach Packages
library(tidyverse)
library(tidyr)
library(janitor)
library(ggbeeswarm)
library(kableExtra)
library(effsize)
library(ggridges)
```

### 1. Introduction

The Pacific Giant Salamander (Dicamptodon tenebrosus) is one of Oregon's largest native amphibians (Oregon Wild). They are typically the dominant vertebrate predator in high gradient streams and an indicator species of healthy waterways (Parker 1994).  This amphibian is dependent on clean aquatic habitats for survival; however, logging and other human activities can severely affect their stream habitats (Oregon Wild). This report will explore the weight and abundance of giant salamander populations in two sections (clear cut and old growth) of Mack Creek in the H.J. experimental Forest. This data was collected by Stanley Gregory from 1993 to 2017, which is one of the longest continuous records of salmonid populations (Gregory S.V. 2016). Here, we use the data to explore relationships between salamander weight and abundance in several sections and channels of the creek. 

![**Figure 1.** Pacific Giant Salamander. *Credit:* Gary Nafis](pacific_giant_salamander.jpg)


### 2. Data and Methods

Data for Pacific Giant Salamander abundance, weight and location from 1993-2017 was collected by [Stanley V. Gregory](https://portal.edirepository.org/nis/mapbrowse?scope=knb-lter-and&identifier=4027&revision=12).

### 3. Results


#### Results A
```{r}
salamander_data <- read_csv("mack_creek_vertebrates.csv") %>% 
  clean_names() %>% 
   filter(species == "DITE") 

salamander_data$section[salamander_data$section == "CC"] <- "Clear Cut"
salamander_data$section[salamander_data$section == "OG"] <- "Old Growth"

salamander_data$unittype[salamander_data$unittype == "C"] <- "Cascade"
salamander_data$unittype[salamander_data$unittype =="SC"] <- "Side-channel"
salamander_data$unittype[salamander_data$unittype == "P"] <- "Pool"


```

```{r}
# Read in data and tidy data
pacific_salamander <- salamander_data %>% 
  count(year, section)

# Plot data
ggplot(pacific_salamander, aes(x = year, y = n))+
  geom_line(aes(color = section)) +
  theme_bw()+
  scale_x_continuous(limits = c(1993,2017), expand = c(0,0))+
  scale_y_continuous(limits = c(0, 400),
                     expand = c(0,0))+
  theme(legend.position = c(0.2, 0.8), 
        legend.background = element_rect(fill = "transparent"),
        legend.key.height = unit(5, "mm"),
        legend.key.width = unit(5, "mm")) +
  labs(title = "Pacific Salamander abundance by section of Mack Creek, Oregon (1993-2017)",
       x = "Year",
       y = "Total Salamander Count")

# Add figure caption
```


#### Results B

```{r}
# create table of salamnder counts in different unit types by section for 2017
salamander_2017 <- salamander_data %>% 
  filter(year == "2017", 
         unittype %in% c("Cascade","Side-channel","Pool")) %>% 
  count(section, unittype)

salamander_2017_table <- salamander_2017 %>% 
  pivot_wider(names_from = unittype, values_from = n)

#add proportions to table
salamander_2017_props <- salamander_2017_table %>% 
  adorn_percentages(denominator = "row") %>% 
  adorn_pct_formatting(digits = 1) %>% 
  adorn_ns(position = "front")

salamander_2017_props %>% 
  kable(digits = 2,
        caption = "Table 1. Counts and Proportions of Salamanders observed at different channel types in Mack Creek for clear-cut and old-growth sections in 2017.") %>% 
  kable_styling(bootstrap_options = "bordered",
                full_width = FALSE,
                position = "left")
```

#### Results C

```{r}
# perform chi square test of salamnder 2017 counts
salamander_2017_chi_counts <- salamander_2017_table %>% 
  select(-section)

salamander_2017_chi <- chisq.test(salamander_2017_chi_counts)
salamander_2017_chi

```


#### Results D

```{r}
# Perform 2 sample t tests for 2017 old growth and 2017 clear cut sections

# Create Vectors
clear_cut <- salamander_data %>% 
  filter(year == "2017") %>% 
  filter(section == "Clear Cut") %>% 
  pull(weight)

old_growth <- salamander_data %>% 
  filter(year == "2017") %>% 
  filter(section == "Old Growth") %>% 
  pull(weight)

# T test and cohen's d comparing clear cut and old growth sections in 2017
salamander_section_ttest <- t.test(clear_cut, old_growth, na.rm = TRUE)

salamander_section_ttest

# Perform cohen's d test

salamander_section_d <- cohen.d(clear_cut, old_growth, na.rm = TRUE)

salamander_section_d

```


#### ResultS E

```{r}
# Visually compare salamander weights between the three channels

salamander_weight <- salamander_data %>% 
  filter(year == "2017") %>% 
  filter(unittype %in% c("Cascade", "Side-channel", "Pool"))


ggplot(data = salamander_weight, aes(x = weight)) +
  geom_histogram(bins = 12, aes(fill = unittype)) +
  facet_wrap(~unittype, scale = "free")+
labs(y = "Weight (g)", 
       x = "Channel Classification",
       title = "Salamnder weight in 2017 per channel type") +
  theme_bw()
  
```

```{r}
salamander_aov <- aov(weight~unittype, data = salamander_weight) 
summary(salamander_aov)
```




#### References

[1] Gregory S. V. 2016. Aquatic Vertebrate Population Study in Mack Creek, Andrews Experimental Forest, 1987 to present. Environmental Data Initiative. https://doi.org/10.6073/pasta/5de64af9c11579266ef20da2ff32f702. Dataset accessed 11/29/2019.
 
[2] “Pacific Giant Salamander: Oregon Wild.” Pacific Giant Salamander | Oregon Wild, oregonwild.org/wildlife/pacific-giant-salamander.

[3] Parker, Michael S. “Feeding Ecology of Stream-Dwelling Pacific Giant Salamander Larvae (Dicamptodon Tenebrosus).” Copeia, vol. 1994, no. 3, 1994, pp. 705–718. JSTOR, www.jstor.org/stable/1447187.